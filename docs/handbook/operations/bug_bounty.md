# Программа баг-баунти lottery_multi

## 1. Цели и зона охвата
- on-chain модули `lottery_multi::*` (кроме тестовых).
- Supra CLI-скрипты для dual-write и AutomationBot.
- Публичные view и JSON Schema `lottery_multi_views.schema.json`.
- Операционные runbook’и и релизные процедуры.

Вне зоны охвата: инфраструктура Supra (кластеры, сеть), фронтендовая монорепа и сторонние интеграции, если иное не указано в релизной записи.

## 2. Классификация уязвимостей
| Уровень | Примеры | Награда |
|---------|---------|---------|
| Критический | Кража средств, нарушение выплат, обход `STATUS_FINALIZED`, манипуляция VRF | Индивидуально (≥ $20k) |
| Высокий | Блокировка продаж, нарушение инвариантов `Accounting`, несогласованность dual-write | $5k–$20k |
| Средний | Некорректные view, обход лимитов AutomationBot, DoS Automation | $1k–$5k |
| Низкий | Ошибки документации, некорректные события, уязвимости CLI | swag / признание |

## 3. Процесс подачи отчётов
1. Отправить письмо на security@supra.xyz с темой `lottery_multi bug bounty`.
2. В теле письма указать:
   - шаги воспроизведения и окружение;
   - ожидаемое и фактическое поведение;
   - возможное влияние и требуемые права;
   - рекомендации по исправлению.
3. При необходимости зашифровать сообщение (PGP ключ — см. [security.md](../../security.md)).
4. Команда безопасности подтверждает получение в течение 48 часов.

## 4. SLA и процесс рассмотрения
- Триаж критических и высоких уязвимостей — 72 часа.
- Исправление критических уязвимостей — до 14 дней, высоких — до 30 дней.
- По завершении подготовить публичный отчёт, обновить `release_checklist.md` и `incident_log.md`.

## 5. Координация с релизами
- Перед релизом обновить перечень известных проблем и статус отчётов.
- В случае активных критических отчётов релиз блокируется до устранения.
- Изменения безопасности вносятся в раздел «Угроза» релизной записи.

## 6. Контакты
- **Security Lead:** А. Сергеев — @asecurity
- **On-chain Owner:** М. Ли — @mlottery
- **DevOps:** Н. Иванова — @ndevops

Все обновления программы публикуются в `docs/handbook/operations/incident_log.md` и релизных заметках.
